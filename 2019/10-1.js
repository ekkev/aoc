const solve = skymap => {
    const asteroids = new Set;
    skymap.split('\n').forEach((row, y) => {
        row.split('').forEach((v, x) => v !== '.' ? asteroids.add([x, y]) : undefined);
    });

    let maxVisible = {size: -Infinity, asteroid: undefined};
    asteroids.forEach(a => {
        let inclines = new Set;
        asteroids.forEach(b => {
            if (a === b) return;
            let incline = Math.atan2(a[1] - b[1], a[0] - b[0]);
            inclines.add(incline);
        });
        if (inclines.size > maxVisible.size) {
            maxVisible = { size: inclines.size, asteroid: a };
        }
    });
    return maxVisible;
}


let test = `.#..#
.....
#####
....#
...##`;
// console.log(solve(test), 8, [3,4]);


test = `......#.#.
#..#.#....
..#######.
.#.#.###..
.#..#.....
..#....#.#
#..#....#.
.##.#..###
##...#..#.
.#....####`;
console.log(solve(test), 33, [5, 8]);

test = `#.#...#.#.
.###....#.
.#....#...
##.#.#.#.#
....#.#.#.
.##..###.#
..#...##..
..##....##
......#...
.####.###.`;
console.log(solve(test), 35, [1, 2]);


test = `.#..##.###...#######
##.############..##.
.#.######.########.#
.###.#######.####.#.
#####.##.#.##.###.##
..#####..#.#########
####################
#.####....###.#.#.##
##.#################
#####.##.###..####..
..######..##.#######
####.##.####...##..#
.#####..#.######.###
##...#.##########...
#.##########.#######
.####.#.###.###.#.##
....##.##.###..#####
.#.#.###########.###
#.#.#.#####.####.###
###.##.####.##.#..##`

console.log(solve(test), 210, [11, 13]);

test = `.###.###.###.#####.#
#####.##.###..###..#
.#...####.###.######
######.###.####.####
#####..###..########
#.##.###########.#.#
##.###.######..#.#.#
.#.##.###.#.####.###
##..#.#.##.#########
###.#######.###..##.
###.###.##.##..####.
.##.####.##########.
#######.##.###.#####
#####.##..####.#####
##.#.#####.##.#.#..#
###########.#######.
#.##..#####.#####..#
#####..#####.###.###
####.#.############.
####.#.#.##########.`;

console.log(solve(test), 214,  [8,16]);